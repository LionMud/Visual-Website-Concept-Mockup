<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Optimization Strategy: New Yorker's Pizza Cura√ßao</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB; /* Tailwind gray-50 */
            color: #374151; /* Tailwind gray-700 for body text */
            font-size: 14px; /* Base font size for a more compact feel */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 300px; /* Significantly reduced */
            margin-left: auto;
            margin-right: auto;
            height: 160px; /* Significantly reduced */
            max-height: 200px;
        }
        @media (min-width: 768px) { 
            .chart-container {
                height: 180px; /* Adjusted for md screens */
            }
        }
        .kpi-card, .content-card, .flow-step, .gemini-feature-card {
            background-color: white;
            border-radius: 0.5rem; /* rounded-lg, slightly less round */
            padding: 0.75rem; /* p-3, reduced */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.07); /* shadow-md, softer shadow */
            border: 1px solid #E5E7EB; /* Tailwind gray-200 border */
            display: flex; 
            flex-direction: column; 
            height: 100%; 
        }
        .kpi-card .text-gray-600, .content-card p, .flow-step p {
            flex-grow: 1; 
            color: #4B5563; 
            text-align: left;
            font-size: 0.75rem; /* text-xs */
            line-height: 1.4; 
        }
        .content-card .text-center, .kpi-card .text-center, .flow-step .text-center {
            text-align: center;
        }
        .kpi-card:hover, .content-card:hover, .flow-step:hover {
            transform: translateY(-2px); 
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.07), 0 4px 6px -2px rgb(0 0 0 / 0.07); /* shadow-lg, softer */
        }
        .flow-arrow {
            color: #00A1E4; 
            font-size: 1.5rem; /* text-xl, reduced */
            line-height: 1;
            font-weight: 600;
        }
        .gemini-button {
            background-color: #FFA500; 
            color: white;
            font-weight: 600; 
            padding: 0.375rem 1rem; /* py-1.5 px-4 */
            font-size: 0.75rem; /* text-xs */
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-block; 
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); /* shadow-sm */
        }
        .gemini-button:hover {
            background-color: #FF8C00; 
            transform: translateY(-1px); 
            box-shadow: 0 2px 4px -1px rgb(0 0 0 / 0.06), 0 1px 2px -1px rgb(0 0 0 / 0.06); /* shadow */
        }
        .loading-spinner {
            border: 2.5px solid #E5E7EB; 
            border-top: 2.5px solid #FFA500; 
            border-radius: 50%;
            width: 16px; 
            height: 16px; 
            animation: spin 1s linear infinite;
            margin: 0.5rem auto; 
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        h1, h2, h3, h4, h5, h6 {
            color: #1E40AF; 
        }
        /* Specific text size adjustments for ultra compact view */
        h1 { font-size: 1.5rem; line-height: 1.875rem; } /* text-2xl */
        header p { font-size: 0.875rem; line-height: 1.25rem; } /* text-sm */
        main h2 { font-size: 1.125rem; line-height: 1.5rem; margin-bottom: 0.5rem;} /* text-lg */
        main h3 { font-size: 1rem; line-height: 1.375rem; margin-bottom: 0.75rem;}   /* text-base for section titles */
        main section > p { font-size: 0.875rem; line-height: 1.25rem; margin-bottom: 1rem; } /* text-sm for section intros */
        .kpi-card .text-3xl { font-size: 1.875rem; line-height: 2.25rem; } /* text-3xl was 4xl */
        .kpi-card .text-sm { font-size: 0.75rem; line-height: 1rem; } /* text-xs was sm */
        .content-card h4 { font-size: 0.875rem; line-height: 1.25rem; margin-bottom: 0.5rem; } /* text-sm */
        .trilingual-item h5 { font-size: 0.75rem; line-height: 1rem;} /* text-xs */
        .trilingual-item p { font-size: 0.6875rem; line-height: 0.875rem; } /* smaller than xs */
        .triggers-item h5 { font-size: 0.75rem; line-height: 1rem; } /* text-xs */
        .triggers-item p { font-size: 0.6875rem; line-height: 0.875rem; }
        .flow-step .text-md { font-size: 0.875rem; line-height: 1.25rem; } /* text-sm */
        .flow-step .text-sm { font-size: 0.75rem; line-height: 1rem; } /* text-xs */
        .flow-step p { font-size: 0.6875rem; line-height: 0.875rem; } /* smaller than xs */
        .gemini-feature-card h4 { font-size: 0.875rem; line-height: 1.25rem; } /* text-sm */
        .gemini-feature-card p { font-size: 0.75rem; line-height: 1rem; margin-bottom: 0.5rem; } /* text-xs */
        .kpi-table th, .kpi-table td { font-size: 0.6875rem; line-height: 0.875rem; padding: 0.375rem; } /* p-1.5 */
        footer p { font-size: 0.6875rem; line-height: 0.875rem; }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm sticky top-0 z-50"> 
        <nav class="container mx-auto px-3 py-1.5"> 
            <h1>Optimizing for the Cura√ßao Market</h1> 
            <p class="text-center text-blue-600 font-medium">A Data-Driven Strategy for New Yorker's Pizza</p> 
        </nav>
    </header>

    <main class="container mx-auto max-w-5xl px-3 py-3 md:py-4"> 
        <div class="lg:grid lg:grid-cols-2 lg:gap-x-6">
            <div class="lg:col-span-1">
                <section id="intro" class="mb-6 text-left"> 
                    <h2>Unlocking Growth for New Yorker's Pizza</h2> 
                    <p class="max-w-none text-gray-600 leading-relaxed">This analysis synthesizes market research to provide a clear, data-driven roadmap for enhancing brand traction, conversion, and engagement in Cura√ßao. The following visualizations distill key insights into actionable strategies, transforming the menu from a price list into a powerful sales tool.</p>
                </section>

                <section id="key-insights" class="mb-6"> 
                    <h3>üí° At a Glance: The High-Impact Landscape</h3> 
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-2.5"> 
                        <div class="kpi-card"> 
                            <div class="text-3xl font-black text-blue-500 text-center">104%</div> 
                            <div class="text-sm font-semibold my-0.5 text-blue-700 text-center">Mobile Penetration</div> 
                            <p class="text-gray-600 mt-0.5">Mobile connections exceed the total population, making a mobile-first strategy non-negotiable.</p> 
                        </div>
                        <div class="kpi-card">
                            <div class="text-3xl font-black text-blue-500 text-center">98%</div>
                            <div class="text-sm font-semibold my-0.5 text-blue-700 text-center">WhatsApp Open Rate</div>
                            <p class="text-gray-600 mt-0.5">This channel offers near-guaranteed message delivery, making it a primary tool for orders and engagement.</p>
                        </div>
                        <div class="kpi-card">
                            <div class="text-3xl font-black text-blue-500 text-center">94%</div>
                            <div class="text-sm font-semibold my-0.5 text-blue-700 text-center">Influence of Online Reviews</div>
                            <p class="text-gray-600 mt-0.5">An overwhelming majority of diners choose restaurants based on reviews, highlighting the power of a strong Google Business Profile.</p>
                        </div>
                    </div>
                </section>

                <section id="consumer-profile" class="mb-6"> 
                    <h3>üë§ Understanding the Cura√ßao Consumer</h3>
                    <p class="max-w-none text-gray-600 mb-3 leading-relaxed">A successful strategy begins with a deep understanding of the target audience. The Cura√ßao market is characterized by its multilingual nature, significant digital adoption, and specific demographic concentrations.</p>
                    <div class="grid grid-cols-1 gap-2.5 items-stretch"> 
                        <div class="content-card">
                            <h4 class="text-center text-blue-500">Digital Connectivity</h4>
                            <div class="chart-container my-auto"> 
                                <canvas id="digitalPenetrationChart"></canvas>
                            </div>
                            <p class="text-gray-600 mt-1 text-center flex-grow">With over two-thirds of the population online and high social media usage, digital channels are the primary arena for marketing and customer engagement.</p>
                        </div>
                        <div class="content-card">
                            <h4 class="text-center text-blue-500">Key Age Demographics</h4>
                            <div class="chart-container my-auto">
                                <canvas id="ageDemographicsChart"></canvas>
                            </div>
                            <p class="text-gray-600 mt-1 text-center flex-grow">The 25-34 age group is a prime target demographic, typically more digitally engaged and open to new culinary experiences, while the significant 65+ segment may have different ordering preferences.</p>
                        </div>
                        <div class="content-card justify-center"> 
                            <h4 class="text-center text-blue-500">The Trilingual Advantage</h4>
                            <div class="space-y-2 mt-1"> 
                                <div class="flex items-center space-x-1.5 trilingual-item">
                                    <span class="text-lg">üá®üáº</span> 
                                    <div>
                                        <h5 class="font-semibold text-blue-700">Papiamentu</h5>
                                        <p class="text-gray-600">For warmth, cultural connection, and building local rapport. Essential for creating a sense of community.</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-1.5 trilingual-item">
                                    <span class="text-lg">üá¨üáß</span>
                                     <div>
                                        <h5 class="font-semibold text-blue-700">English</h5>
                                        <p class="text-gray-600">For broad accessibility, catering to both locals and the vital tourism market.</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-1.5 trilingual-item">
                                    <span class="text-lg">üá≥üá±</span>
                                    <div>
                                        <h5 class="font-semibold text-blue-700">Dutch</h5>
                                        <p class="text-gray-600">For formal communications and appealing to specific demographic segments.</p>
                                    </div>
                                </div>
                            </div>
                            <p class="text-gray-600 mt-1.5 text-center">A multilingual approach on the menu and in marketing is not just a courtesy‚Äîit's a strategic tool for maximizing reach and resonance.</p>
                        </div>
                    </div>
                </section>
            </div>

            <div class="lg:col-span-1">
                <section id="market-dynamics" class="mb-6"> 
                    <h3>üìà Market Dynamics & Consumer Behavior</h3>
                    <p class="max-w-none text-gray-600 mb-3 leading-relaxed">Consumer choices are driven by a mix of economic realities, payment preferences, and psychological triggers. Aligning the brand's offerings with these behaviors is crucial for conversion.</p>
                     <div class="grid grid-cols-1 gap-2.5 items-stretch">
                         <div class="content-card">
                            <h4 class="text-center text-blue-500">Payment Preferences Shift</h4>
                             <div class="chart-container my-auto">
                                <canvas id="paymentChart"></canvas>
                            </div>
                            <p class="text-gray-600 mt-1 text-center flex-grow">While cash remains relevant, the adoption of digital payments like Sentoo is rapidly growing, especially in food delivery. Offering both is key to catering to all customers.</p>
                        </div>
                        <div class="content-card">
                            <h4 class="text-center text-blue-500">Psychological Triggers for Trial</h4>
                            <div class="space-y-1.5 mt-1 flex-grow flex flex-col justify-center text-left pl-1"> 
                                <div class="flex items-start triggers-item">
                                    <span class="text-sm text-blue-500 mr-1 mt-0.5">‚úî</span> 
                                    <div>
                                        <h5 class="font-semibold text-blue-700">Authenticity & Novelty</h5>
                                        <p class="text-gray-600">The "True NYC experience" is a powerful hook, appealing to the desire for genuine and new dining concepts.</p>
                                    </div>
                                </div>
                                <div class="flex items-start triggers-item">
                                    <span class="text-sm text-blue-500 mr-1 mt-0.5">‚úî</span>
                                    <div>
                                        <h5 class="font-semibold text-blue-700">Scarcity & Urgency</h5>
                                        <p class="text-gray-600">Well-executed Limited Time Offers (LTOs) create excitement and motivate immediate purchase decisions.</p>
                                    </div>
                                </div>
                                <div class="flex items-start triggers-item">
                                    <span class="text-sm text-blue-500 mr-1 mt-0.5">‚úî</span>
                                    <div>
                                        <h5 class="font-semibold text-blue-700">Social Proof</h5>
                                        <p class="text-gray-600">Positive online reviews and local influencer recommendations are highly persuasive in driving first-time visits.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="aiMarketingSection" class="gemini-feature-card text-center">
                        <h4 class="text-blue-500">AI-Powered Marketing Idea ‚ú®</h4>
                        <p class="text-gray-600 max-w-md mx-auto">Leverage AI to craft a compelling marketing message based on these triggers and Cura√ßao's unique linguistic landscape.</p>
                        <button id="generateMarketingSnippetBtn" class="gemini-button">‚ú® Create AI Marketing Snippet</button>
                        <div id="marketingSnippetLoading" class="loading-spinner" style="display: none;"></div>
                        <div id="marketingSnippetResult" class="mt-2 text-gray-700 text-left bg-blue-50 p-1.5 rounded-md"></div>
                        <div id="marketingSnippetError" class="mt-1.5 text-red-600"></div>
                    </div>
                </section>
                
                <section id="recommendations" class="mb-6"> 
                    <h3>üó∫Ô∏è A Phased Roadmap to Optimization</h3>
                     <p class="max-w-none text-gray-600 mb-3 leading-relaxed">Transforming the menu and brand requires a structured approach. This flow outlines a path from immediate high-impact changes to long-term strategic adjustments, ensuring sustainable growth.</p>
                    <div class="relative">
                        <div class="flex flex-col md:flex-row items-stretch justify-center space-y-2.5 md:space-y-0 md:space-x-2"> 
                            <div class="flow-step w-full md:w-1/3"> 
                                <div>
                                    <div class="text-md font-bold text-blue-500">Phase 1</div>
                                    <h4 class="text-sm font-semibold text-blue-700">High-ROI Quick Wins</h4>
                                </div>
                                <p class="text-gray-600 flex-grow">Visual/copy overhaul, QR code integration, basic price tiering, and clearer contact info.</p>
                            </div>
                            <div class="flow-arrow hidden md:flex items-center justify-center">‚ûî</div>
                            <div class="flow-arrow block md:hidden transform rotate-90 mx-auto w-min my-1">‚ûî</div>
                            <div class="flow-step w-full md:w-1/3">
                                <div>
                                    <div class="text-md font-bold text-blue-500">Phase 2</div>
                                    <h4 class="text-sm font-semibold text-blue-700">Mid-Term Upgrades</h4>
                                </div>
                                <p class="text-gray-600 flex-grow">Develop a full multilingual strategy, amplify the brand story, and launch a UGC/review generation plan.</p>
                            </div>
                            <div class="flow-arrow hidden md:flex items-center justify-center">‚ûî</div>
                            <div class="flow-arrow block md:hidden transform rotate-90 mx-auto w-min my-1">‚ûî</div>
                            <div class="flow-step w-full md:w-1/3">
                                 <div>
                                    <div class="text-md font-bold text-blue-500">Phase 3</div>
                                    <h4 class="text-sm font-semibold text-blue-700">Long-Term Strategy</h4>
                                </div>
                                <p class="text-gray-600 flex-grow">Full menu engineering, invest in a dedicated online order platform, and ongoing staff training.</p>
                            </div>
                        </div>
                    </div>
                     <div id="aiSummarySection" class="gemini-feature-card text-center">
                        <h4 class="text-blue-500">AI-Powered Strategic Snapshot ‚ú®</h4>
                        <p class="text-gray-600 max-w-md mx-auto">Get an AI-generated summary of key strategic priorities based on the market data presented.</p>
                        <button id="generateSummaryBtn" class="gemini-button">‚ú® Generate AI Strategic Summary</button>
                        <div id="summaryLoading" class="loading-spinner" style="display: none;"></div>
                        <div id="summaryResult" class="mt-2 text-gray-700 text-left bg-blue-50 p-1.5 rounded-md"></div>
                        <div id="summaryError" class="mt-1.5 text-red-600"></div>
                    </div>
                </section>
                
                <section id="kpis" class="mb-6"> 
                     <h3>üéØ Measuring Success: Key Performance Indicators</h3>
                     <p class="max-w-none text-gray-600 mb-3 leading-relaxed">To ensure these strategies deliver results, it's essential to track key performance indicators. These metrics will provide clear insight into business health and customer satisfaction.</p>
                    <div class="bg-white rounded-lg shadow-xl p-2 md:p-2.5"> 
                        <h4 class="text-sm font-semibold mb-1.5 text-center text-blue-500">Target Performance Benchmarks</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left kpi-table">
                                <thead class="bg-gray-100">
                                    <tr>
                                        <th class="font-semibold text-blue-700">KPI</th>
                                        <th class="font-semibold text-blue-700">Target / Benchmark</th>
                                        <th class="font-semibold text-blue-700">Why It Matters</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200">
                                    <tr class="hover:bg-gray-50">
                                        <td class="font-medium text-blue-600">LTV:CAC Ratio</td>
                                        <td class="font-semibold text-gray-700">&ge; 3:1</td>
                                        <td class="text-gray-600">Ensures customer acquisition is profitable and sustainable.</td>
                                    </tr>
                                    <tr class="hover:bg-gray-50">
                                        <td class="font-medium text-blue-600">Average Order Value (AOV)</td>
                                        <td class="font-semibold text-gray-700">&gt; XCG 35</td>
                                        <td class="text-gray-600">Increases revenue per transaction through upselling and combos.</td>
                                    </tr>
                                    <tr class="hover:bg-gray-50">
                                        <td class="font-medium text-blue-600">Net Promoter Score (NPS)</td>
                                        <td class="font-semibold text-gray-700">&gt; 50 (Excellent)</td>
                                        <td class="text-gray-600">Measures customer loyalty and willingness to recommend the brand.</td>
                                    </tr>
                                     <tr class="hover:bg-gray-50">
                                        <td class="font-medium text-blue-600">Google Review Rating</td>
                                        <td class="font-semibold text-gray-700">&ge; 4.5 Stars</td>
                                        <td class="text-gray-600">Directly impacts local search visibility and new customer trial.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <footer class="bg-blue-800 text-white text-center p-2 mt-4"> 
        <p>&copy; 2025 Market Analysis for New Yorker's Pizza Cura√ßao. Data-driven insights for growth.</p>
    </footer>

    <script>
        const wrapLabel = (str, maxWidth) => {
            if (!str || typeof str.length === 'undefined') { return ''; }
            if (str.length <= maxWidth) { return str; }
            const words = str.split(' ');
            const lines = [];
            let currentLine = words.length > 0 ? words[0] : '';
            for (let i = 1; i < words.length; i++) {
                if ((currentLine + ' ' + words[i]).length > maxWidth) {
                    lines.push(currentLine);
                    currentLine = words[i];
                } else {
                    currentLine += ' ' + words[i];
                }
            }
            lines.push(currentLine);
            return lines;
        };

        const TOOLTIP_CONFIG = {
            plugins: {
                tooltip: {
                    titleFont: { weight: '600', size: 9 }, 
                    bodyFont: { size: 8 }, 
                    padding: 4,  
                    boxPadding: 1.5, 
                    callbacks: {
                        title: function(tooltipItems) {
                            const item = tooltipItems[0];
                            if (!item || !item.chart || !item.chart.data || !item.chart.data.labels || typeof item.dataIndex === 'undefined') { return ''; }
                            let label = item.chart.data.labels[item.dataIndex];
                            return Array.isArray(label) ? label.join(' ') : label;
                        }
                    }
                }
            }
        };

        const chartColors = ['#00A1E4', '#33B5E5', '#66C9E5', '#99DDE5', '#CCE1E5'];

        const createDigitalPenetrationChart = () => {
            const ctx = document.getElementById('digitalPenetrationChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: [wrapLabel('Internet Users (68.1%)', 10), wrapLabel('Non-Users (31.9%)', 10)], 
                    datasets: [{ data: [68.1, 31.9], backgroundColor: [chartColors[0], chartColors[2]], borderColor: '#F9FAFB', borderWidth: 1, hoverOffset: 2 }]
                },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { position: 'bottom', labels: { color: '#4B5563', font: { size: 8, family: 'Inter, sans-serif' }, padding: 4 }}, ...TOOLTIP_CONFIG.plugins }}
            });
        };

        const createAgeDemographicsChart = () => {
            const ctx = document.getElementById('ageDemographicsChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['0-24', '25-34', '35-54', '55-64', '65+'],
                    datasets: [{ label: 'Population %', data: [31.5, 16.8, 25.5, 8.9, 17.3], backgroundColor: chartColors[1], borderColor: '#007BB5', borderWidth: 0.5, borderRadius: 2, barPercentage: 0.35, categoryPercentage: 0.5 }]
                },
                options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, ticks: { callback: function(v) { return v + '%' }, color: '#4B5563', font: { size: 7 } }, grid: { color: '#E5E7EB', drawBorder: false } }, x: { ticks: { color: '#4B5563', font: { size: 7 } }, grid: { display: false }}}, plugins: { legend: { display: false }, ...TOOLTIP_CONFIG.plugins }}
            });
        };

        const createPaymentChart = () => {
            const ctx = document.getElementById('paymentChart').getContext('2d');
             new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: [wrapLabel('Digital (Sentoo) Growing', 10), wrapLabel('Cash Relevant',10)], 
                    datasets: [{ label: 'Payment Preference', data: [60, 40], backgroundColor: [chartColors[0], chartColors[3]], borderColor: '#F9FAFB', borderWidth: 1, hoverOffset: 2 }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { color: '#4B5563', font: { size: 8, family: 'Inter, sans-serif' }, padding: 4 }}, ...TOOLTIP_CONFIG.plugins, tooltip: { ...TOOLTIP_CONFIG.plugins.tooltip, bodyColor: '#F9FAFB', backgroundColor: '#1E40AF', borderColor: '#33B5E5', borderWidth: 1, callbacks: { ...TOOLTIP_CONFIG.plugins.tooltip.callbacks, label: function(c) { let l = c.dataset.label||''; if(l){l+=': '} if(c.parsed!==null){l+=c.parsed+'%'} return l;}}}}}
            });
        };

        async function callGeminiAPI(prompt, resultElId, loadingElId, errorElId) {
            const resultEl = document.getElementById(resultElId);
            const loadingEl = document.getElementById(loadingElId);
            const errorEl = document.getElementById(errorElId);
            loadingEl.style.display = 'block'; resultEl.innerHTML = ''; errorEl.innerHTML = '';
            const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) { const errData = await response.json(); throw new Error(errData.error ? errData.error.message : `API Error ${response.status}`); }
                const result = await response.json();
                if (result.candidates && result.candidates[0]?.content?.parts?.[0]) {
                    let rawText = result.candidates[0].content.parts[0].text;
                    const lines = rawText.split('\n').map(l => l.replace(/^[\s]*[\*\-\+]\s*/, '').trim()).filter(l => l.length > 0);
                    resultEl.innerHTML = `<div class="prose prose-xs max-w-none leading-snug">${lines.join('<br class="my-0.5">')}</div>`;
                } else { throw new Error("No content from API."); }
            } catch (error) { console.error("Gemini API Error:", error); errorEl.innerHTML = `Error: ${error.message}`; }
            finally { loadingEl.style.display = 'none'; }
        }

        const generateSummaryBtn = document.getElementById('generateSummaryBtn');
        if (generateSummaryBtn) {
            generateSummaryBtn.addEventListener('click', () => {
                const promptText = "Based on New Yorker's Pizza in Cura√ßao data: Mobile 104%, WhatsApp Open 98%, Online Review Influence 94%, Prime Demo 25-34yrs, Digital Payments (Sentoo) growing, Triggers (Authenticity, Scarcity, Social Proof), Trilingual need (Papiamentu, English, Dutch) ‚Äì provide a concise strategic summary (max 3 bullet points, each on a new line, starting with an emoji like üöÄ or ‚ú® or üéØ) highlighting top priorities for growth. Be direct and actionable.";
                callGeminiAPI(promptText, 'summaryResult', 'summaryLoading', 'summaryError');
            });
        }
        const generateMarketingSnippetBtn = document.getElementById('generateMarketingSnippetBtn');
        if (generateMarketingSnippetBtn) {
            generateMarketingSnippetBtn.addEventListener('click', () => {
                const promptText = "For New Yorker's Pizza in Cura√ßao: Key triggers are Authenticity (NYC experience), Scarcity (LTOs), Social Proof. Leverage Papiamentu, English, Dutch. Generate one short, catchy marketing snippet (max 30 words, include an emoji üçï or üî•) combining a trigger & multilingual hint or NYC style. Make it engaging for Cura√ßao.";
                callGeminiAPI(promptText, 'marketingSnippetResult', 'marketingSnippetLoading', 'marketingSnippetError');
            });
        }
        window.onload = function() {
            if (document.getElementById('digitalPenetrationChart')) createDigitalPenetrationChart();
            if (document.getElementById('ageDemographicsChart')) createAgeDemographicsChart();
            if (document.getElementById('paymentChart')) createPaymentChart();
        };
    </script>
</body>
</html>
